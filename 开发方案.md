# 英语教材生成器实施计划

## 项目概述

创建一个基于 React + Vite 的 Web 应用，允许用户上传文档、粘贴文本或输入 URL，通过 Claude AI 自动生成结构化的英语教学材料，并支持导出为 PDF/图片格式。

## 技术栈

- **前端框架**: React 19.2.0 + Vite 7.2.4
- **样式系统**: Tailwind CSS 4.x（复用现有 glassmorphism 设计）
- **文件处理**: react-dropzone, mammoth.js (Word), pdfjs-dist (PDF)
- **AI 集成**: @anthropic-ai/sdk（客户端直连，用户自带 API Key）
- **内容处理**: cheerio (HTML解析), turndown (HTML转Markdown)
- **导出功能**: html-to-image, jsPDF, marked (Markdown渲染)
- **UI 组件**: lucide-react (图标库)

## 核心功能

### 1. 多种输入方式
- **文件上传**: 支持 Word (.docx, .doc), PDF, TXT, HTML 文件
- **文本粘贴**: 直接粘贴任意文本内容
- **URL 提取**: 输入网页 URL 自动提取内容

### 2. 灵活配置选项
- 英语难度级别: A1, A2, B1, B2, C1, C2
- 词汇量范围: 1000-2000, 2000-4000, 4000-6000, 6000-10000, 10000+
- 学习目标: 听力、口语、词汇、语法、写作、演讲表达（多选）
- 输出语言: 中文、英文、双语
- 字幕格式: 带时间码的 SRT / 纯文本
- 输出风格: 完整版 / 简化版

### 3. AI 生成教材（9个章节）
0. 参数回显
1. 内容总览（摘要、关键词、观点）
2. 核心词汇表（表格：单词、音标、词性、释义、例句）
3. 高频短语与句型
4. 语法与表达微课
5. 听力训练（填空、判断题）
6. 口语与写作任务
7. 场景扩展与模拟对话
8. 跟读与语音练习
9. 巩固复习材料（Anki 卡片、7天计划）

### 4. 导出功能
- 导出为 PDF（打印友好格式）
- 导出为 PNG 图片
- 下载 HTML 文件
- 可折叠章节（答案隐藏/显示）

### 5. 历史记录
- 本地存储生成历史
- 快速加载历史教材
- 删除历史记录

## 项目结构

```
english-teaching-generator/
├── index.html
├── package.json
├── vite.config.js
├── tailwind.config.js
├── postcss.config.js
├── src/
│   ├── main.jsx
│   ├── App.jsx
│   ├── index.css
│   ├── components/
│   │   ├── layout/
│   │   │   ├── Header.jsx
│   │   │   └── Footer.jsx
│   │   ├── input/
│   │   │   ├── InputTabs.jsx
│   │   │   ├── FileUploadZone.jsx
│   │   │   ├── TextPasteArea.jsx
│   │   │   └── URLExtractor.jsx
│   │   ├── config/
│   │   │   ├── ConfigPanel.jsx
│   │   │   ├── LevelSelector.jsx
│   │   │   ├── VocabRangeSlider.jsx
│   │   │   ├── GoalsCheckbox.jsx
│   │   │   ├── LanguageToggle.jsx
│   │   │   ├── SubtitleFormatToggle.jsx
│   │   │   └── StyleToggle.jsx
│   │   ├── processing/
│   │   │   ├── ProcessingModal.jsx
│   │   │   └── ProgressBar.jsx
│   │   ├── output/
│   │   │   ├── MaterialPreview.jsx
│   │   │   ├── CollapsibleSection.jsx
│   │   │   ├── VocabularyTable.jsx
│   │   │   └── ExportButtons.jsx
│   │   └── history/
│   │       ├── HistorySidebar.jsx
│   │       └── HistoryItem.jsx
│   ├── services/
│   │   ├── fileParser.js
│   │   ├── contentExtractor.js
│   │   ├── aiService.js
│   │   ├── templateGenerator.js
│   │   └── exportService.js
│   ├── utils/
│   │   ├── textCleaner.js
│   │   ├── markdownRenderer.js
│   │   └── localStorage.js
│   └── constants/
│       ├── prompts.js
│       └── config.js
└── dist/
```

## 实施步骤

### 阶段 1: 项目初始化（第1天）
1. 创建 Vite + React 项目
2. 安装所有依赖包
3. 配置 Tailwind CSS
4. 复用 HTML转图片工具的 glassmorphism 样式
5. 创建基础布局（Header, Footer, 主容器）

### 阶段 2: 输入模块（第2-4天）
1. 实现 InputTabs 组件（切换输入方式）
2. 实现 FileUploadZone（参考 image-compressor 的 UploadZone）
   - 拖拽上传
   - 文件类型验证
   - 文件预览
3. 实现文件解析服务
   - Word 文档解析（mammoth.js）
   - PDF 解析（pdfjs-dist）
   - HTML 解析（cheerio + turndown）
   - 纯文本读取
4. 实现 TextPasteArea（文本粘贴区）
5. 实现 URLExtractor（URL 提取器）
   - 使用 CORS 代理或提示用户复制内容

### 阶段 3: 配置面板（第5-6天）
1. 创建 ConfigPanel 容器组件
2. 实现所有配置子组件
   - LevelSelector: 6个难度级别按钮
   - VocabRangeSlider: 词汇量范围滑块
   - GoalsCheckbox: 6个学习目标多选框
   - LanguageToggle: 中文/英文/双语切换
   - SubtitleFormatToggle: SRT/纯文本切换
   - StyleToggle: 完整版/简化版切换
3. 实现配置状态管理（useState）
4. 实现配置持久化（localStorage）

### 阶段 4: AI 集成（第7-9天）
1. 创建 aiService.js
   - 集成 @anthropic-ai/sdk
   - 实现 API Key 管理（首次输入、加密存储、验证）
   - 实现流式响应处理
   - 构建详细的提示词模板
2. 创建 prompts.js
   - 定义完整的教材生成提示词
   - 包含所有9个章节的格式要求
   - 支持参数化配置
3. 实现 ProcessingModal
   - 显示生成进度
   - 流式显示生成内容
   - 支持取消操作
4. 错误处理和重试机制

### 阶段 5: 输出渲染（第10-12天）
1. 实现 Markdown 到 HTML 转换（marked.js）
2. 创建 MaterialPreview 组件
   - 渲染9个章节
   - 打印友好样式
3. 实现 CollapsibleSection（可折叠章节）
4. 实现 VocabularyTable（词汇表格）
5. 创建 templateGenerator.js
   - 生成完整的 HTML 模板
   - 包含打印样式
   - 支持 A4 纸张布局

### 阶段 6: 导出功能（第13-14天）
1. 创建 exportService.js
2. 实现 PDF 导出（jsPDF）
   - 优化分页
   - 保持表格完整性
3. 实现图片导出（html-to-image）
4. 实现 HTML 下载
5. 创建 ExportButtons 组件
   - 3个导出按钮
   - 导出进度提示

### 阶段 7: 历史记录（第15天）
1. 实现 localStorage 管理（参考 HTML转图片工具）
2. 创建 HistorySidebar 组件
3. 创建 HistoryItem 组件
4. 实现加载历史记录
5. 实现删除历史记录

### 阶段 8: 优化与测试（第16-18天）
1. 性能优化
   - 大文件处理优化
   - 长文本渲染优化
   - 代码分割（React.lazy）
2. 用户体验优化
   - 加载状态
   - 错误提示
   - 成功反馈
3. 响应式设计
   - 移动端适配
   - 平板适配
4. 跨浏览器测试
5. 完善文档和注释

### 阶段 9: 部署上线（第19天）
1. 构建生产版本（npm run build）
2. 部署到 AWS S3 或 Nginx
3. 配置域名和 HTTPS
4. 添加 Umami 分析
5. 更新主站 portal 的链接

## 关键文件参考

实施时需要参考以下现有项目文件：

1. **HTML 转图片工具/src/App.jsx** - 状态管理、模态框、历史记录模式
2. **GOOLGEAD/image-compressor/src/components/UploadZone.jsx** - 文件上传实现
3. **HTML 转图片工具/src/index.css** - Glassmorphism 设计系统
4. **考研资讯站/src/services/newsService.js** - API 调用模式
5. **GOOLGEAD/image-compressor/src/utils/fileHandler.js** - 文件处理工具

## 技术挑战与解决方案

### 1. 大文件处理
- **挑战**: PDF/Word 文档可能很大，解析耗时
- **方案**:
  - 限制文件大小（10MB）
  - 使用 Web Worker 后台解析
  - 显示解析进度

### 2. AI 响应时间
- **挑战**: 生成完整教材需要 30-60 秒
- **方案**:
  - 使用流式响应实时显示
  - 显示生成进度（章节数）
  - 允许取消操作

### 3. API Key 安全
- **挑战**: 客户端存储 API Key 有泄露风险
- **方案**:
  - localStorage 加密存储
  - 提示用户使用限额较低的 Key
  - 添加使用量监控

### 4. PDF 导出质量
- **挑战**: 复杂表格可能导致排版问题
- **方案**:
  - 使用 A4 纸张优化布局
  - 实现自动分页
  - 提供打印预览

### 5. 跨域 URL 提取
- **挑战**: 浏览器 CORS 限制
- **方案**:
  - 使用 CORS 代理服务
  - 提示用户复制粘贴内容
  - 未来可开发浏览器扩展

## 验证计划

### 功能测试
1. **输入测试**
   - 上传不同格式文件（Word, PDF, TXT, HTML）
   - 粘贴长文本（>5000字）
   - 输入各种 URL（新闻、博客、文档）

2. **配置测试**
   - 测试所有难度级别
   - 测试不同词汇范围
   - 测试各种学习目标组合

3. **AI 生成测试**
   - 测试短文本（<500字）
   - 测试中等文本（500-2000字）
   - 测试长文本（>2000字）
   - 验证9个章节都正确生成

4. **导出测试**
   - 导出 PDF 并检查排版
   - 导出图片并检查清晰度
   - 下载 HTML 并在浏览器中打开

5. **历史记录测试**
   - 保存多个教材
   - 加载历史教材
   - 删除历史记录

### 性能测试
- 测试 10MB 大文件上传
- 测试 5000+ 字长文本生成
- 测试导出 20+ 页 PDF

### 兼容性测试
- Chrome, Firefox, Safari, Edge
- macOS, Windows
- 移动端浏览器（iOS Safari, Chrome）

## 成功标准

1. ✅ 支持至少 3 种输入方式（文件、粘贴、URL）
2. ✅ 支持至少 3 种文件格式（Word, PDF, TXT）
3. ✅ 成功调用 Claude API 生成教材
4. ✅ 生成的教材包含所有 9 个章节
5. ✅ 支持导出 PDF 和图片
6. ✅ 历史记录功能正常
7. ✅ 移动端基本可用
8. ✅ 生成时间 < 2 分钟（对于 2000 字文本）

## 项目目录

新项目将创建在: `/Users/chenzhang/Documents/个站/english-teaching-generator/`

## 预计完成时间

总计 19 天（约 3 周），按每天 4-6 小时工作量计算。
